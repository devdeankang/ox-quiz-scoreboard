<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>크아앙 제2회 이벤트 점수판</title>
  <style>
    body {
      margin: 0;
      font-family: "Arial", sans-serif;
      background: url('babydragon.jpg') no-repeat center center fixed;
      background-size: cover;
    }

    .overlay {
      background-color: rgba(255, 255, 255, 0.7); /* 70% 불투명도 */
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 2rem;
    }

    .container {
      background: white;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      padding: 2rem;
      width: 100%;
      max-width: 800px;
      text-align: center;
    }

    h1 {
      font-size: 2rem;
      margin-bottom: 1.5rem;
    }

    table {
      width: 90%;
      margin: 0 auto 1rem;
      border-collapse: collapse;
      table-layout: fixed;
    }

    .entry-row td {
      padding: 0.5rem 1rem;
      border-bottom: 1px solid #ddd;
      white-space: nowrap;
    }

    .entry-row td.name {
      text-align: left;
      width: 70%;
    }

    .entry-row td.score {
      text-align: right;
      width: 30%;
    }

    input, button {
      margin-top: 0.5rem;
      padding: 0.5rem;
      font-size: 1rem;
    }

    .admin-actions {
      display: flex;
      gap: 1rem;
      margin-top: 1rem;
      justify-content: center;
      flex-wrap: wrap;
    }

    .admin-actions button {
      flex: 1 1 auto;
      min-width: 120px;
    }

    .edit-controls {
      margin-top: 0.3rem;
      display: flex;
      gap: 0.5rem;
      justify-content: flex-end;
    }

    .edit-controls input {
      width: 50px;
      text-align: center;
    }

    .entry-controls button {
      margin-left: 0.3rem;
    }

    .rank-icon {
      margin-right: 0.4rem;
    }
  </style>
</head>
<body>
  <div class="overlay">
    <div class="container">
      <h1>🐍 크아앙 제2회 이벤트 점수판</h1>
      <table id="scoreboard"></table>

      <div id="admin-login">
        <input type="password" id="admin-password" placeholder="운영진 비밀번호"/>
        <button onclick="loginAdmin()">운영진 로그인</button>
      </div>

      <div id="admin-panel" style="display: none;">
        <input type="text" id="new-name" placeholder="닉네임"/>
        <button onclick="addParticipant()">참가자 추가</button>
        <div class="admin-actions">
          <button style="background-color: gold;" onclick="resetScores()">점수 초기화</button>
          <button style="background-color: red; color: white;" onclick="resetAll()">모두 초기화</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    const password = "kuaang123";
    let isAdmin = false;
    let participants = [];

    function renderScoreboard() {
      const table = document.getElementById("scoreboard");
      table.innerHTML = "";

      const sorted = [...participants].sort((a, b) => b.score - a.score);
      sorted.forEach((p, i) => {
        const row = document.createElement("tr");
        row.className = "entry-row";

        let medal = "";
        if (i === 0) medal = "🥇";
        else if (i === 1) medal = "🥈";
        else if (i === 2) medal = "🥉";

        const nameCell = document.createElement("td");
        nameCell.className = "name";
        nameCell.textContent = `${i + 1}. ${p.name}`;
        if (medal) nameCell.innerHTML = `${medal} ${i + 1}. ${p.name}`;

        const scoreCell = document.createElement("td");
        scoreCell.className = "score";
        scoreCell.textContent = `${p.score}점`;

        if (isAdmin) {
          const controlDiv = document.createElement("div");
          controlDiv.className = "edit-controls";

          const scoreInput = document.createElement("input");
          scoreInput.type = "number";
          scoreInput.value = p.score;
          scoreInput.onchange = () => {
            p.score = parseInt(scoreInput.value);
            renderScoreboard();
          };

          const editBtn = document.createElement("button");
          editBtn.textContent = "이름수정";
          editBtn.onclick = () => {
            const newName = prompt("새 이름을 입력하세요:", p.name);
            if (!newName || newName.trim() === "") return;
            if (participants.some(x => x.name === newName.trim())) {
              alert("같은 이름이 이미 존재합니다!");
              return;
            }
            p.name = newName.trim();
            renderScoreboard();
          };

          const delBtn = document.createElement("button");
          delBtn.textContent = "삭제";
          delBtn.onclick = () => {
            if (confirm(`${p.name} 참가자를 삭제할까요?`)) {
              participants = participants.filter(x => x !== p);
              renderScoreboard();
            }
          };

          controlDiv.appendChild(scoreInput);
          controlDiv.appendChild(editBtn);
          controlDiv.appendChild(delBtn);
          scoreCell.appendChild(controlDiv);
        }

        row.appendChild(nameCell);
        row.appendChild(scoreCell);
        table.appendChild(row);
      });
    }

    function loginAdmin() {
      const input = document.getElementById("admin-password").value;
      if (input === password) {
        isAdmin = true;
        document.getElementById("admin-login").style.display = "none";
        document.getElementById("admin-panel").style.display = "block";
        renderScoreboard();
      } else {
        alert("비밀번호가 틀렸습니다.");
      }
    }

    function addParticipant() {
      const nameInput = document.getElementById("new-name");
      const name = nameInput.value.trim();
      if (!name) return;
      if (participants.some(p => p.name === name)) {
        alert("같은 이름이 이미 등록되어 있습니다!");
        return;
      }
      participants.push({ name, score: 0 });
      nameInput.value = "";
      renderScoreboard();
    }

    function resetScores() {
      if (confirm("점수를 모두 0점으로 초기화할까요?")) {
        participants.forEach(p => p.score = 0);
        renderScoreboard();
      }
    }

    function resetAll() {
      if (confirm("모든 참가자를 삭제하고 초기화할까요?")) {
        participants = [];
        renderScoreboard();
      }
    }
  </script>
</body>
</html>
